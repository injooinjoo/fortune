## 🏴‍☠️ Fortune App 프로젝트 가이드

### 🔄 프로젝트 인식 및 컨텍스트
- **항상 이 `CLAUDE.md` 파일을 먼저 읽어** 핵심 지침을 이해하세요.
- 작업 전에 프로젝트 구조를 스캔하여 기존 패턴을 이해하세요.
- 프로젝트와 `examples/` 폴더에서 찾은 일관된 명명 규칙, 파일 구조 및 아키텍처 패턴을 사용하세요.

### 🏗️ 프로젝트 구조
- **Framework**: Next.js 15 (App Router)
- **언어**: TypeScript
- **스타일링**: Tailwind CSS + shadcn/ui
- **데이터베이스**: Supabase (PostgreSQL)
- **AI**: OpenAI GPT-4, Google Teachable Machine
- **인증**: Supabase Auth (Google OAuth)

### 🧱 코드 구조 및 모듈성
- **파일 길이**: 500줄을 초과하는 파일을 만들지 마세요. 접근하면 리팩토링 계획을 제안하세요.
- **코드 구성**: 기능이나 책임별로 그룹화된 명확하게 분리된 모듈로 구성하세요.
- **임포트**: 상대 경로 대신 절대 경로 사용 (예: `@/lib/services/fortune-service`)
- **환경 변수**: 환경 변수는 서버 컴포넌트에서만 직접 접근하세요.

### 🧪 테스트 및 신뢰성
- **항상 새 기능에 대한 테스트를 생성하세요**. 테스트는 선택사항이 아닙니다.
- **테스트는 `__tests__/` 폴더에** 메인 애플리케이션 구조를 반영하여 위치해야 합니다.
- 각 새 함수나 클래스에 대해 다음을 테스트하세요:
  1. "해피 패스" (예상 입력 및 출력)
  2. 최소 하나의 일반적인 엣지 케이스 (예: 빈 리스트, 0 값, null 입력)
  3. 최소 하나의 실패 케이스 (예: 잘못된 입력이 특정 오류 발생)

### ✍️ 스타일 및 규칙
- **언어**: TypeScript 4.x+
- **포맷팅**: Prettier 설정을 엄격히 준수. `npm run format` 사용
- **타입 힌팅**: 모든 함수와 메서드는 인수와 반환 값에 대한 완전한 타입 힌트를 가져야 합니다.
- **컴포넌트**: 
  - 서버 컴포넌트가 기본 (클라이언트 상호작용이 필요한 경우만 'use client' 사용)
  - shadcn/ui 컴포넌트 우선 사용
  - Framer Motion으로 애니메이션 구현

### 🔐 보안 고려사항
- **절대 하드코딩 금지**: API 키, 데이터베이스 URL 등은 환경 변수로만
- **입력 검증**: 모든 사용자 입력은 서버에서 검증
- **에러 처리**: 민감한 정보가 클라이언트에 노출되지 않도록 주의
- **CORS**: API 라우트에 적절한 CORS 헤더 설정

### 🧠 AI 동작 규칙
- **가정하기 전에 묻기**: 요구사항이 모호하거나 컨텍스트가 부족하면 가정하지 말고 명확히 하세요.
- **환각 금지**: 실제로 존재하는 라이브러리와 함수만 사용하세요.
- **경로 확인**: 파일을 참조하기 전에 프로젝트 구조에 존재하는지 확인하세요.
- **점진적 변경**: 기존 파일을 수정할 때 집중적이고 점진적인 변경을 하세요.
- **이유 설명**: 복잡하거나 중요한 코드 섹션에는 구현 선택의 "이유"를 설명하는 인라인 주석을 추가하세요.

### 📝 표준 워크플로우
1. **PRP 생성**: 새 기능 요청에 대해 `/generate-prp INITIAL.md` 명령 사용
2. **PRP 실행**: 생성된 PRP를 `/execute-prp PRPs/기능명.md`로 실행
3. **검증 루프**: 항상 린트, 타입 체크, 테스트를 실행하여 코드 품질 보장
4. **한국어 응답**: 모든 사용자 커뮤니케이션은 한국어로 작성

### 🚀 Fortune 앱 특수 규칙
1. **운세 생성**: AI 모델 호출은 항상 서버 사이드에서만
2. **캐싱**: 운세 결과는 Redis 또는 메모리 캐시에 저장
3. **사용자 경험**: 로딩 상태, 에러 처리, 스켈레톤 UI 필수
4. **모바일 우선**: 모든 UI는 모바일 먼저 고려
5. **접근성**: WCAG 2.1 AA 기준 준수

### 📋 개발 완료 후 필수 체크리스트
개발 작업을 완료한 후에는 반드시 다음 두 가지를 수행하세요:

#### 1. 🔒 보안 검토 (Security Review)
작성한 모든 코드를 검토하여 보안 모범 사례를 따르는지 확인하세요:
- **프론트엔드 검증**: 민감한 정보가 프론트엔드에 노출되지 않았는지 확인
- **API 보안**: API 키, 비밀번호 등이 환경 변수로만 관리되는지 확인
- **입력 검증**: 모든 사용자 입력이 서버에서 검증되는지 확인
- **인증/인가**: 적절한 권한 체크가 이루어지는지 확인
- **XSS/CSRF**: 보안 취약점이 없는지 확인
- **SQL Injection**: 파라미터화된 쿼리 사용 여부 확인

#### 2. 📚 상세 코드 설명 (Code Walkthrough)
구현한 기능과 코드를 상세히 설명하세요:
- **변경 사항 요약**: 무엇을 변경했는지 명확히 설명
- **작동 원리**: 코드가 어떻게 작동하는지 단계별로 설명
- **아키텍처 설명**: 컴포넌트/모듈 간의 관계 설명
- **주요 함수/클래스**: 핵심 로직을 담당하는 부분 설명
- **선배 엔지니어처럼**: 주니어 개발자에게 가르치듯이 친절하고 상세하게 설명
- **모범 사례**: 사용한 패턴이나 기법의 장점 설명