# Gitleaks configuration for Fortune project

[allowlist]
description = "Allowlisted files and patterns"
paths = [
    '''\.env\.example$''',
    '''\.env\..*\.example$''',
    '''firebase_options_secure\.dart$''',
    '''secrets\.txt$''',
    '''test''',
    '''mock''',
]

[[rules]]
description = "Firebase API Key"
regex = '''AIza[0-9A-Za-z\-_]{35}'''
tags = ["key", "Firebase"]

[[rules]]
description = "Stripe API Key"
regex = '''(?i)(sk|pk)_(test|live)_[0-9a-zA-Z]{24,}'''
tags = ["key", "Stripe"]

[[rules]]
description = "JWT"
regex = '''eyJ[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.?[A-Za-z0-9-_.+/=]*'''
tags = ["key", "JWT"]

[[rules]]
description = "OpenAI API Key"
regex = '''sk-[A-Za-z0-9]{48}'''
tags = ["key", "OpenAI"]

[[rules]]
description = "Generic Secret"
regex = '''(?i)(api_key|apikey|secret|password|passwd|pwd|token|api_token|private_key|client_secret)\s*[=:]\s*["\']?[A-Za-z0-9\-_.=]{10,}["\']?'''
tags = ["secret", "generic"]

# Custom rules for Fortune project
[[rules]]
description = "Supabase Service Role Key"
regex = '''SUPABASE_SERVICE_ROLE_KEY\s*=\s*["\']?[A-Za-z0-9\-_.=]+["\']?'''
tags = ["key", "Supabase"]

[[rules]]
description = "Redis/Upstash Token"
regex = '''UPSTASH_REDIS_REST_TOKEN\s*=\s*["\']?[A-Za-z0-9\-_.=]+["\']?'''
tags = ["token", "Redis"]