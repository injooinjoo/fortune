# ìë™ QA ì‹œìŠ¤í…œ (Playwright MCP ê¸°ë°˜)

> ìµœì¢… ì—…ë°ì´íŠ¸: 2025.01.03

ê°œë°œ ì™„ë£Œ í›„ ì‹¤ì œ ì•±ì„ ìë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸í•˜ì—¬ ê¸°ëŠ¥ì´ ì •ìƒ ë™ì‘í•˜ëŠ”ì§€ ê²€ì¦í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

## ê°œìš”

```
ê°œë°œ ì‘ì—… ì™„ë£Œ
      â†“
ìë™ QA íŠ¸ë¦¬ê±°
      â†“
Playwright MCP ì‹¤í–‰
      â†“
ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤ì œ í…ŒìŠ¤íŠ¸
      â†“
ê²°ê³¼ ë¦¬í¬íŠ¸ ìƒì„±
```

---

## ì‚¬ì „ ì¤€ë¹„

### 1. Playwright MCP ì„œë²„ ì„¤ì •

`.claude/settings.local.json`ì— Playwright MCPê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

```json
{
  "mcpServers": {
    "playwright": {
      "command": "npx",
      "args": ["-y", "@anthropic/mcp-server-playwright"],
      "env": {
        "PLAYWRIGHT_HEADLESS": "false",
        "PLAYWRIGHT_TIMEOUT": "30000"
      }
    }
  }
}
```

### 2. Flutter Web ì„œë²„ ì‹¤í–‰

í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ì„œëŠ” Flutter Web ì•±ì´ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤:

```bash
# ê°œë°œ ì„œë²„ ì‹¤í–‰ (í¬íŠ¸ 3000)
flutter run -d chrome --web-port=3000

# ë˜ëŠ” ë¹Œë“œ í›„ ì„œë²„ ì‹¤í–‰
flutter build web
npx serve build/web -l 3000
```

### 3. í…ŒìŠ¤íŠ¸ í™˜ê²½ ë³€ìˆ˜

`.env.test` íŒŒì¼ì— í…ŒìŠ¤íŠ¸ ê³„ì • ì •ë³´ê°€ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

```env
# í…ŒìŠ¤íŠ¸ ëª¨ë“œ í”Œë˜ê·¸
FLUTTER_TEST_MODE=true
BYPASS_AUTH=true

# í…ŒìŠ¤íŠ¸ ê³„ì •
TEST_ACCOUNT_EMAIL=test@fortune.com
TEST_ACCOUNT_PASSWORD=TestFortuneApp2025!@#SecurePassword
```

---

## ì‚¬ìš© ë°©ë²•

### Skill ì‹¤í–‰

```bash
# íŠ¹ì • í˜ì´ì§€ í…ŒìŠ¤íŠ¸
/sc:auto-qa /fortune/daily

# ì „ì²´ E2E í…ŒìŠ¤íŠ¸
/sc:auto-qa all

# ìµœê·¼ ë³€ê²½ëœ í˜ì´ì§€ ìë™ ê°ì§€
/sc:auto-qa
```

### CLI ì§ì ‘ ì‹¤í–‰

```bash
# Playwright í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npx playwright test playwright/tests/e2e/fortune.spec.js

# íŠ¹ì • í…ŒìŠ¤íŠ¸ë§Œ
npx playwright test -g "daily fortune"

# ë””ë²„ê·¸ ëª¨ë“œ (ë¸Œë¼ìš°ì € í‘œì‹œ)
npx playwright test --headed --debug
```

---

## ìë™ ì‹¤í–‰ íŠ¸ë¦¬ê±°

ë‹¤ìŒ ì‘ì—… ì™„ë£Œ ì‹œ ìë™ìœ¼ë¡œ QAê°€ ì‹¤í–‰ë©ë‹ˆë‹¤:

| íŠ¸ë¦¬ê±° | ì¡°ê±´ | í…ŒìŠ¤íŠ¸ ë²”ìœ„ |
|--------|------|------------|
| ìš´ì„¸ í˜ì´ì§€ ìˆ˜ì • | `*_fortune_page.dart` ë³€ê²½ | í•´ë‹¹ ìš´ì„¸ í˜ì´ì§€ |
| UI ì»´í¬ë„ŒíŠ¸ ìˆ˜ì • | `presentation/widgets/` ë³€ê²½ | ê´€ë ¨ í˜ì´ì§€ë“¤ |
| Edge Function ë°°í¬ | `supabase functions deploy` í›„ | API ì—°ë™ í…ŒìŠ¤íŠ¸ |
| êµ¬ë… ìˆ˜ì • | `premium` ì½”ë“œ ë³€ê²½ | êµ¬ë… í”Œë¡œìš° |
| ë¼ìš°íŒ… ìˆ˜ì • | `route_config.dart` ë³€ê²½ | ë„¤ë¹„ê²Œì´ì…˜ í…ŒìŠ¤íŠ¸ |

### ìë™ íŠ¸ë¦¬ê±° ë¹„í™œì„±í™”

íŠ¹ì • ìƒí™©ì—ì„œ ìë™ QAë¥¼ ê±´ë„ˆë›°ë ¤ë©´:

```bash
# ì»¤ë°‹ ë©”ì‹œì§€ì— [skip-qa] í¬í•¨
git commit -m "fix: typo [skip-qa]"
```

---

## í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. ìš´ì„¸ í˜ì´ì§€ ì‹œë‚˜ë¦¬ì˜¤ (`fortune-page`)

```
1. í˜ì´ì§€ ë¡œë”© (networkidle ëŒ€ê¸°)
2. Flutter ì•± ì´ˆê¸°í™” ëŒ€ê¸° (3ì´ˆ)
3. ë©”ì¸ ì½˜í…ì¸  í™•ì¸ (ìš´ì„¸, ì˜¤ëŠ˜ ë“± í‚¤ì›Œë“œ)
4. ì…ë ¥ í¼ ì¡´ì¬ í™•ì¸
5. ìš´ì„¸ ìƒì„± ë²„íŠ¼ í´ë¦­
6. ë¡œë”© ìƒíƒœ í™•ì¸ ë° ì™„ë£Œ ëŒ€ê¸°
7. ê²°ê³¼ í™”ë©´ ë Œë”ë§ í™•ì¸
8. ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜
```

**ì ìš© í˜ì´ì§€**: `/fortune/*`, `/saju/*`, `/tarot/*`

### 2. ì¼ë°˜ í˜ì´ì§€ ì‹œë‚˜ë¦¬ì˜¤ (`page-render`)

```
1. í˜ì´ì§€ ë¡œë”©
2. Flutter ì´ˆê¸°í™” ëŒ€ê¸°
3. ì½˜í…ì¸  ë Œë”ë§ í™•ì¸
4. ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜
```

**ì ìš© í˜ì´ì§€**: `/home`, `/profile`, `/subscription` ë“±

### 3. ì¸ì¦ í”Œë¡œìš° ì‹œë‚˜ë¦¬ì˜¤ (`auth-flow`)

```
1. ëœë”© í˜ì´ì§€ ì ‘ê·¼
2. ë¡œê·¸ì¸ ë²„íŠ¼ í™•ì¸
3. í…ŒìŠ¤íŠ¸ ê³„ì • ë¡œê·¸ì¸ (BYPASS_AUTH)
4. í™ˆ í™”ë©´ ë¦¬ë‹¤ì´ë ‰íŠ¸ í™•ì¸
```

---

## ê²€ì¦ í•­ëª©

### ê³µí†µ ê²€ì¦

| í•­ëª© | ì„¤ëª… | ì¤‘ìš”ë„ |
|------|------|--------|
| ì½˜ì†” ì—ëŸ¬ | JavaScript ì½˜ì†” ì—ëŸ¬ ì—†ìŒ | ë†’ìŒ |
| ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ | API 4xx/5xx ì‘ë‹µ ì—†ìŒ | ë†’ìŒ |
| í˜ì´ì§€ ë¡œë”© | 30ì´ˆ ë‚´ ë¡œë”© ì™„ë£Œ | ë†’ìŒ |
| UI ë Œë”ë§ | ì£¼ìš” ìš”ì†Œ í‘œì‹œ | ì¤‘ê°„ |

### ìš´ì„¸ í˜ì´ì§€ ê²€ì¦

| í•­ëª© | ì„¤ëª… |
|------|------|
| ì…ë ¥ í¼ | ìƒë…„ì›”ì¼, ì‹œê°„, ì„±ë³„ ì…ë ¥ ê°€ëŠ¥ |
| ìš´ì„¸ ìƒì„± | ë²„íŠ¼ í´ë¦­ í›„ API í˜¸ì¶œ |
| ë¡œë”© ìƒíƒœ | ë¡œë”© ì¸ë””ì¼€ì´í„° í‘œì‹œ |
| ê²°ê³¼ í‘œì‹œ | ìš´ì„¸ ê²°ê³¼ í™”ë©´ ë Œë”ë§ |

---

## ì¸ì¦ ì²˜ë¦¬

### í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì¸ì¦

í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œëŠ” ì¸ì¦ì„ ìš°íšŒí•©ë‹ˆë‹¤:

```javascript
// auth.helper.js
await page.addInitScript(() => {
  window.FLUTTER_TEST_MODE = true;
  window.BYPASS_AUTH = true;
  window.TEST_ACCOUNT_EMAIL = 'test@fortune.com';
});
```

### Flutter ì•± ë‚´ ì²˜ë¦¬

`TestAuthService`ê°€ í…ŒìŠ¤íŠ¸ ëª¨ë“œë¥¼ ê°ì§€í•˜ê³  ìë™ ë¡œê·¸ì¸í•©ë‹ˆë‹¤:

```dart
// lib/core/services/test_auth_service.dart
static bool isTestMode() {
  return const String.fromEnvironment('FLUTTER_TEST_MODE') == 'true';
}
```

---

## ê²°ê³¼ ë¦¬í¬íŠ¸

### ì„±ê³µ ì‹œ

```
============================================
ğŸ­ ìë™ QA í…ŒìŠ¤íŠ¸ ê²°ê³¼
============================================

ğŸ“ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ: /fortune/daily
ğŸ• ì‹¤í–‰ ì‹œê°„: 2024-01-15T10:30:00

í…ŒìŠ¤íŠ¸ í•­ëª©:
  âœ… í˜ì´ì§€ ë¡œë”©
  âœ… Flutter ì´ˆê¸°í™”
  âœ… ë©”ì¸ ì½˜í…ì¸ 
  âœ… ì¸í„°ë™ì…˜
  âœ… ìŠ¤í¬ë¦°ìƒ·

ğŸ“¸ ìŠ¤í¬ë¦°ìƒ·:
  - playwright/screenshots/fortune-daily-1705312200.png

============================================
ì´ ê²°ê³¼: âœ… PASS
============================================
```

### ì‹¤íŒ¨ ì‹œ

```
============================================
ğŸ­ ìë™ QA í…ŒìŠ¤íŠ¸ ê²°ê³¼
============================================

ğŸ“ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ: /fortune/daily
ğŸ• ì‹¤í–‰ ì‹œê°„: 2024-01-15T10:30:00

í…ŒìŠ¤íŠ¸ í•­ëª©:
  âœ… í˜ì´ì§€ ë¡œë”©
  âœ… Flutter ì´ˆê¸°í™”
  âŒ ë©”ì¸ ì½˜í…ì¸ 
  â­ï¸ ì¸í„°ë™ì…˜ (ìŠ¤í‚µ)

âš ï¸ ë°œê²¬ëœ ë¬¸ì œ:
  - [console] TypeError: Cannot read property 'data' of undefined
  - [network] 500 - https://api.fortune.com/v1/daily

ğŸ“¸ ìŠ¤í¬ë¦°ìƒ·:
  - playwright/screenshots/error-1705312200.png

============================================
ì´ ê²°ê³¼: âŒ FAIL
============================================

ê¶Œì¥ ì¡°ì¹˜:
1. ì½˜ì†” ì—ëŸ¬ í™•ì¸ í›„ í•´ë‹¹ ì½”ë“œ ìˆ˜ì •
2. API ì‘ë‹µ í™•ì¸ (Edge Function ë¡œê·¸ ì²´í¬)
3. /sc:analyze-errorë¡œ ê·¼ë³¸ ì›ì¸ ë¶„ì„
```

---

## íŒŒì¼ êµ¬ì¡°

```
playwright/
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ e2e/
â”‚       â”œâ”€â”€ fortune.spec.js      # ìš´ì„¸ E2E í…ŒìŠ¤íŠ¸
â”‚       â”œâ”€â”€ auth.spec.js         # ì¸ì¦ í…ŒìŠ¤íŠ¸
â”‚       â””â”€â”€ navigation.spec.js   # ë„¤ë¹„ê²Œì´ì…˜ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ scenarios/
â”‚   â”œâ”€â”€ fortune-page.scenario.js # ìš´ì„¸ í˜ì´ì§€ ì‹œë‚˜ë¦¬ì˜¤
â”‚   â””â”€â”€ index.js                 # ì‹œë‚˜ë¦¬ì˜¤ ì¸ë±ìŠ¤
â”œâ”€â”€ helpers/
â”‚   â””â”€â”€ auth.helper.js           # ì¸ì¦ í—¬í¼
â”œâ”€â”€ screenshots/                 # í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦°ìƒ·
â”œâ”€â”€ global-setup.js              # ì „ì—­ ì„¤ì •
â””â”€â”€ global-teardown.js           # ì „ì—­ ì •ë¦¬

playwright.config.js             # Playwright ì„¤ì •
.env.test                        # í…ŒìŠ¤íŠ¸ í™˜ê²½ ë³€ìˆ˜
```

---

## ê´€ë ¨ Agent

| Agent | ì—­í•  |
|-------|------|
| `playwright-qa-agent` | E2E í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° ê²°ê³¼ ë¶„ì„ |
| `testing-architect` | í…ŒìŠ¤íŠ¸ ì „ëµ ë° ì»¤ë²„ë¦¬ì§€ ê´€ë¦¬ |
| `error-resolver` | í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ ê·¼ë³¸ ì›ì¸ ë¶„ì„ |

---

## ê´€ë ¨ Skill

| Skill | ìš©ë„ |
|-------|------|
| `/sc:auto-qa` | ìë™ QA ì‹¤í–‰ |
| `/sc:quality-gate` | í’ˆì§ˆ ê²Œì´íŠ¸ (í…ŒìŠ¤íŠ¸ í¬í•¨) |
| `/sc:analyze-error` | ì—ëŸ¬ ë¶„ì„ |

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ì„œë²„ ì—°ê²° ì‹¤íŒ¨

```
Error: net::ERR_CONNECTION_REFUSED
```

**í•´ê²°**: Flutter Web ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
```bash
curl http://localhost:3000
```

### Flutter ì•± ë¡œë”© ì‹¤íŒ¨

```
Error: Timeout waiting for page to load
```

**í•´ê²°**: íƒ€ì„ì•„ì›ƒ ì¦ê°€ ë˜ëŠ” Flutter ë¹Œë“œ í™•ì¸
```bash
flutter clean && flutter pub get && flutter run -d chrome
```

### ì¸ì¦ ìš°íšŒ ì‹¤íŒ¨

```
Error: Redirected to login page
```

**í•´ê²°**: TestAuthService í™•ì¸, í™˜ê²½ ë³€ìˆ˜ ì„¤ì • í™•ì¸
```dart
// main.dartì—ì„œ í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì²˜ë¦¬ í™•ì¸
if (TestAuthService.isTestMode()) {
  await TestAuthService().autoLoginTestAccount();
}
```

### ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ

```
Error: Element not found: text=ìš´ì„¸
```

**í•´ê²°**: Flutter Webì—ì„œëŠ” ì¼ë°˜ DOM ì…€ë ‰í„°ê°€ ë‹¤ë¥´ê²Œ ë™ì‘í•©ë‹ˆë‹¤.
- `flt-semantics` íƒœê·¸ ì‚¬ìš©
- í…ìŠ¤íŠ¸ ê¸°ë°˜ ì…€ë ‰í„° ì‚¬ìš© (`text=ìš´ì„¸`)
- waitForTimeoutìœ¼ë¡œ ì¶©ë¶„í•œ ëŒ€ê¸° ì‹œê°„ í™•ë³´